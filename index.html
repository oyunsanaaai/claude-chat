<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude AI –ß–∞—Ç</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .message-enter { animation: fadeIn 0.3s ease-out; }
    .dark { color-scheme: dark; }
    * { box-sizing: border-box; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="app">
    <!-- Header -->
    <div class="bg-white border-b border-gray-200 px-6 py-4">
      <div class="flex items-center justify-between max-w-5xl mx-auto">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center text-2xl">
            ü§ñ
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-900">Claude AI –ß–∞—Ç</h1>
            <p class="text-xs text-gray-600" id="status">üî¥ API Key —Ö—ç—Ä—ç–≥—Ç—ç–π</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button onclick="toggleTheme()" class="p-2 hover:bg-gray-100 rounded-full" id="themeBtn">
            üåô
          </button>
          <button onclick="clearChat()" class="p-2 hover:bg-gray-100 rounded-full" title="–¶—ç–≤—ç—Ä–ª—ç—Ö">
            üóëÔ∏è
          </button>
          <button onclick="openSettings()" class="p-2 hover:bg-gray-100 rounded-full" title="–¢–æ—Ö–∏—Ä–≥–æ–æ">
            ‚öôÔ∏è
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white rounded-2xl p-6 max-w-md w-full">
        <h2 class="text-2xl font-bold mb-4 text-gray-900">‚öôÔ∏è –¢–æ—Ö–∏—Ä–≥–æ–æ</h2>
        <label class="block mb-2 text-gray-600 font-semibold">Claude API Key</label>
        <input 
          type="password" 
          id="apiKeyInput"
          placeholder="sk-ant-api03-..."
          class="w-full px-4 py-3 rounded-lg bg-gray-100 text-gray-900 mb-2 outline-none border-2 border-transparent focus:border-purple-500"
        />
        <p class="text-xs text-gray-500 mb-4">
          üìç <a href="https://console.anthropic.com/settings/keys" target="_blank" class="text-purple-500 hover:underline">console.anthropic.com</a>-—Å API Key –∞–≤–Ω–∞
        </p>
        <div class="flex gap-2">
          <button onclick="saveApiKey()" class="flex-1 bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-semibold">
            –•–∞–¥–≥–∞–ª–∞—Ö
          </button>
          <button onclick="closeSettings()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-900 py-3 rounded-lg font-semibold">
            –•–∞–∞—Ö
          </button>
        </div>
      </div>
    </div>

    <!-- Messages -->
    <div id="messages" class="h-[calc(100vh-200px)] overflow-y-auto px-4 py-6 bg-gray-50">
      <div class="max-w-4xl mx-auto space-y-6">
        <div class="text-center py-12" id="emptyState">
          <div class="text-6xl mb-4">ü§ñ</div>
          <h2 class="text-2xl font-bold mb-2 text-gray-900">Claude AI-—Ç–∞–π —á–∞—Ç–ª–∞—Ö</h2>
          <p class="text-gray-600 mb-6">–ê—Å—É—É–ª—Ç –∞—Å—É—É–≥–∞–∞—Ä–∞–π</p>
          <button onclick="openSettings()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold">
            üîë API Key –æ—Ä—É—É–ª–∞—Ö
          </button>
        </div>
      </div>
    </div>

    <!-- Input -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-4">
      <div class="max-w-4xl mx-auto flex gap-3">
        <input 
          type="text" 
          id="messageInput"
          placeholder="–ú–µ—Å—Å–µ–∂ –±–∏—á–∏—Ö..."
          class="flex-1 px-5 py-4 rounded-xl bg-gray-100 text-gray-900 outline-none border-2 border-transparent focus:border-purple-500"
          onkeypress="handleKeyPress(event)"
        />
        <button onclick="sendMessage()" id="sendBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-4 rounded-xl font-semibold">
          üì§ –ò–ª–≥—ç—ç—Ö
        </button>
      </div>
    </div>
  </div>

  <script>
    let messages = [];
    let apiKey = '';
    let theme = 'light';
    let loading = false;

    // –≠—Ö–ª“Ø“Ø–ª—ç—Ö
    window.onload = function() {
      apiKey = localStorage.getItem('claude_api_key') || '';
      theme = localStorage.getItem('claude_theme') || 'light';
      const savedMessages = localStorage.getItem('claude_messages');
      
      if (savedMessages) {
        messages = JSON.parse(savedMessages);
        renderMessages();
      }
      
      if (apiKey) {
        document.getElementById('status').textContent = 'üü¢ –•–æ–ª–±–æ–≥–¥—Å–æ–Ω';
        document.getElementById('emptyState').style.display = 'none';
      }
      
      applyTheme();
    };

    // –ó–∞–≥–≤–∞—Ä —Å–æ–ª–∏—Ö
    function toggleTheme() {
      theme = theme === 'light' ? 'dark' : 'light';
      localStorage.setItem('claude_theme', theme);
      applyTheme();
    }

    function applyTheme() {
      const isDark = theme === 'dark';
      document.body.className = isDark ? 'bg-gray-900' : 'bg-gray-50';
      document.getElementById('themeBtn').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      
      // –ë“Ø—Ö —ç–ª–µ–º–µ–Ω—Ç“Ø“Ø–¥–∏–π–≥ —à–∏–Ω—ç—á–ª—ç—Ö
      const elements = document.querySelectorAll('.bg-white, .bg-gray-50, .text-gray-900, .text-gray-600');
      elements.forEach(el => {
        if (isDark) {
          el.classList.add('dark:bg-gray-800', 'dark:text-gray-100');
        }
      });
    }

    // –¢–æ—Ö–∏—Ä–≥–æ–æ
    function openSettings() {
      document.getElementById('settingsModal').classList.remove('hidden');
      document.getElementById('apiKeyInput').value = apiKey;
    }

    function closeSettings() {
      document.getElementById('settingsModal').classList.add('hidden');
    }

    function saveApiKey() {
      const input = document.getElementById('apiKeyInput').value.trim();
      if (!input.startsWith('sk-ant-')) {
        alert('‚ö†Ô∏è API Key –±—É—Ä—É—É –±–∞–π–Ω–∞! "sk-ant-" –≥—ç–∂ —ç—Ö–ª—ç—Ö —ë—Å—Ç–æ–π.');
        return;
      }
      apiKey = input;
      localStorage.setItem('claude_api_key', apiKey);
      document.getElementById('status').textContent = 'üü¢ –•–æ–ª–±–æ–≥–¥—Å–æ–Ω';
      closeSettings();
      alert('‚úÖ –•–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞!');
    }

    // –ú–µ—Å—Å–µ–∂ –∏–ª–≥—ç—ç—Ö
    async function sendMessage() {
      const input = document.getElementById('messageInput');
      const userMessage = input.value.trim();
      
      if (!userMessage || loading) return;
      
      if (!apiKey) {
        alert('‚ö†Ô∏è API Key –æ—Ä—É—É–ª–Ω–∞ —É—É!');
        openSettings();
        return;
      }

      loading = true;
      document.getElementById('sendBtn').disabled = true;
      document.getElementById('sendBtn').innerHTML = '‚è≥ –ò–ª–≥—ç—ç–∂ –±–∞–π–Ω–∞...';
      document.getElementById('emptyState').style.display = 'none';
      
      // –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –º–µ—Å—Å–µ–∂ –Ω—ç–º—ç—Ö
      messages.push({
        role: 'user',
        content: userMessage,
        timestamp: new Date().toISOString()
      });
      
      input.value = '';
      renderMessages();
      
      try {
        const response = await fetch('https://api.anthropic.com/v1/messages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': apiKey,
            'anthropic-version': '2023-06-01'
          },
          body: JSON.stringify({
            model: 'claude-3-5-sonnet-20241022',
            max_tokens: 4096,
            messages: messages.map(msg => ({
              role: msg.role,
              content: msg.content
            }))
          })
        });

        const data = await response.json();
        
        if (!response.ok) {
          throw new Error(data.error?.message || 'API –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞');
        }

        const assistantMessage = data.content[0].text;
        
        messages.push({
          role: 'assistant',
          content: assistantMessage,
          timestamp: new Date().toISOString()
        });
        
        localStorage.setItem('claude_messages', JSON.stringify(messages));
        renderMessages();

      } catch (error) {
        messages.push({
          role: 'assistant',
          content: `‚ùå –ê–ª–¥–∞–∞: ${error.message}\n\n–®–∞–ª–≥–∞—Ö –∑“Ø–π–ª—Å:\n‚úì API Key –∑”©–≤ —ç—Å—ç—Ö\n‚úì –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ö–æ–ª–±–æ–ª—Ç\n‚úì –ö—Ä–µ–¥–∏—Ç “Ø–ª–¥—ç–≥–¥—ç–ª`,
          timestamp: new Date().toISOString(),
          error: true
        });
        renderMessages();
      } finally {
        loading = false;
        document.getElementById('sendBtn').disabled = false;
        document.getElementById('sendBtn').innerHTML = 'üì§ –ò–ª–≥—ç—ç—Ö';
      }
    }

    // –ú–µ—Å—Å–µ–∂“Ø“Ø–¥–∏–π–≥ —Ö–∞—Ä—É—É–ª–∞—Ö
    function renderMessages() {
      const container = document.getElementById('messages').querySelector('.space-y-6');
      container.innerHTML = '';
      
      messages.forEach(msg => {
        const msgDiv = document.createElement('div');
        msgDiv.className = `flex gap-4 message-enter ${msg.role === 'user' ? 'flex-row-reverse' : ''}`;
        
        const avatarColor = msg.role === 'user' ? 'bg-blue-500' : (msg.error ? 'bg-red-500' : 'bg-purple-500');
        const avatar = msg.role === 'user' ? 'üë§' : 'ü§ñ';
        
        msgDiv.innerHTML = `
          <div class="w-8 h-8 rounded-full ${avatarColor} flex items-center justify-center flex-shrink-0">
            ${avatar}
          </div>
          <div class="flex-1 max-w-2xl">
            <div class="bg-white rounded-2xl px-5 py-4 shadow-sm ${msg.error ? 'border-2 border-red-500' : ''}">
              <div class="whitespace-pre-wrap break-words text-gray-900">${escapeHtml(msg.content)}</div>
              <div class="text-xs text-gray-500 mt-2">
                ${new Date(msg.timestamp).toLocaleTimeString('mn-MN')}
              </div>
            </div>
          </div>
        `;
        
        container.appendChild(msgDiv);
      });
      
      scrollToBottom();
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function scrollToBottom() {
      const messagesDiv = document.getElementById('messages');
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    function handleKeyPress(event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    }

    function clearChat() {
      if (confirm('–ë“Ø—Ö –º–µ—Å—Å–µ–∂–∏–π–≥ —É—Å—Ç–≥–∞—Ö —É—É?')) {
        messages = [];
        localStorage.removeItem('claude_messages');
        document.getElementById('messages').querySelector('.space-y-6').innerHTML = '';
        document.getElementById('emptyState').style.display = 'block';
      }
    }
  </script>
</body>
</html>
